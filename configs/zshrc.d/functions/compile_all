compile_all() {
    autoload -Uz zrecompile
    if [ ! -f $ZSH_CONFIG_DIR/init.zsh.zwc ]; then
        zcompile $ZSH_CONFIG_DIR/init.zsh
    else
        zrecompile $ZSH_CONFIG_DIR/init.zsh
    fi

    autosource_dir=$ZSH_CONFIG_DIR/autoload/
    for file in $autosource_dir/*.zsh; do
        if [ ! -f $autosource_dir/$file.zwc ]; then
            zcompile $file
        else
            zrecompile $file
        fi
    done

    libfilename='mylib.zwc'

    eval cd $ZSH_CONFIG_DIR/functions/
    zcompile $libfilename ./*
    cd -
}

# vi: ft=zsh
